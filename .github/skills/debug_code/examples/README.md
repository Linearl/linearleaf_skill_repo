# 调试示例

本目录包含使用 debug_code skill 的示例场景。

## 📋 示例场景

### 场景1: 运行时错误调试

**用户请求**:
> 我的Python程序报错 "TypeError: 'NoneType' object is not subscriptable"

**Copilot 执行流程**:

1. **需求解析**:
   - 问题类型: 运行时错误
   - 错误类型: TypeError
   - 可能原因: 尝试对 None 值进行索引操作

2. **确认信息** (暂停点):
   ```
   我理解您遇到了 TypeError 错误，这通常发生在：
   - 函数返回了 None 而不是预期的列表/字典
   - 变量未正确初始化
   - 条件分支导致某些情况下变量为 None
   
   请确认以上理解是否正确，并提供相关代码片段？
   ```

3. **执行调试循环**:
   - 分析: 定位出错代码行，检查变量来源
   - 修正: 添加 None 检查或修复返回值
   - 执行: 实施修改
   - 验证: 确认错误消失

---

### 场景2: 配置错误排查

**用户请求**:
> 数据库连接失败，报错 "Connection refused"

**Copilot 执行流程**:

1. **分析方向**:
   - 检查连接配置（主机、端口、凭据）
   - 验证数据库服务状态
   - 测试网络连通性

2. **调试步骤**:
   - 打印连接参数确认配置
   - 使用命令行工具测试连接
   - 检查防火墙设置

3. **常见解决方案**:
   - 修正主机名/端口
   - 更新凭据
   - 开放防火墙端口

---

### 场景3: 性能问题排查

**用户请求**:
> 这个API响应很慢，需要5秒以上

**Copilot 执行流程**:

1. **性能分析**:
   - 添加计时点定位瓶颈
   - 检查数据库查询
   - 分析算法复杂度

2. **常见问题**:
   - N+1 查询问题
   - 缺少索引
   - 不必要的循环

3. **优化方案**:
   - 批量查询替代循环查询
   - 添加缓存
   - 优化算法

---

### 场景4: 多轮调试示例

**问题**: 复杂的数据处理逻辑错误

**轮次1**: 初步定位
- 目标: 确定问题范围
- 结果: 发现是数据转换阶段出错

**轮次2**: 深入分析
- 目标: 定位具体转换函数
- 结果: 找到边界条件处理缺失

**轮次3**: 修复验证
- 目标: 实施修复并验证
- 结果: 问题解决，添加单元测试

---

## 💡 使用技巧

### 提供清晰的问题描述

✅ 好的描述:
- "执行 `python main.py` 时在第45行报 KeyError"
- "上传文件超过1MB时返回500错误"
- "每次运行结果不一致，有时正确有时错误"

❌ 模糊的描述:
- "程序不工作"
- "有bug"

### 提供错误信息

包含完整的错误堆栈信息：
```
Traceback (most recent call last):
  File "main.py", line 45, in process_data
    result = data['key']
KeyError: 'key'
```

### 利用暂停点

在每个暂停点：
- 确认问题理解是否正确
- 提供额外的上下文信息
- 反馈测试执行结果

---

## 📁 示例输出结构

```
debug/
└── 1_KeyError修复/
    ├── INDEX.md              # 任务索引
    └── 1/                    # 第1轮调试
        ├── README.md         # 调试记录
        ├── src/              # 测试脚本
        ├── core/             # 修复后的代码
        ├── archive/          # 原始代码备份
        └── logs/             # 测试日志

buglist/
├── bug_list.md
└── fixed/
    └── BUG-001_KeyError问题.md
```
